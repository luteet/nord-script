export default function Popup(t){let e=document.querySelector("body"),o=document.querySelector("html"),i="object"==typeof t&&!!t.saveID,s=!0,n=!0;const c=function(t,n){if(s){s=!1;let c=document.querySelector(t);if(!c)return new Error(`Not found "${t}"`);c.classList.contains("popup")&&(c.style.display="flex",e.classList.remove("is-popup-active"),o.style.setProperty("--popup-padding",window.innerWidth-e.offsetWidth+"px"),e.classList.add("is-popup-active"),i&&history.pushState("","",t),setTimeout(()=>{n?(c.classList.add("is-transition-none"),c.classList.add("is-active"),s=!0):(c.classList.add("is-active"),setTimeout(()=>s=!0,400))},0))}else setTimeout(()=>s=!0,500)},p=function(t){if(n){let s;n=!1,s="string"==typeof t?document.querySelector(t):t.closest(".popup"),s.classList.contains("is-transition-none")&&s.classList.remove("is-transition-none"),setTimeout(()=>{s.classList.remove("is-active"),setTimeout((function(){const t=document.querySelectorAll(".popup.is-active");t.length<1&&(e.classList.remove("is-popup-active"),o.style.setProperty("--popup-padding","0px")),i&&(!function(){let t=window.location.toString();if(t.indexOf("#")>0){let e=t.substring(0,t.indexOf("#"));window.history.replaceState({},document.title,e)}}(),t[t.length-1]&&history.pushState("","","#"+t[t.length-1].getAttribute("id"))),n=!0,s.style.display="none"}),400)},0)}};return{open:function(t){c(t)},close:function(t){p(t)},init:function(){let t;if(e.addEventListener("click",(function(e){t=e.target;let o=t.closest(".open-popup");o&&(e.preventDefault(),c(o.getAttribute("href")));let i=t.closest(".popup-close");i&&p(i)})),e.addEventListener("keyup",(function(t){"Escape"==t.key&&document.querySelector(".popup.is-active")&&p(document.querySelector(".popup.is-active"))})),window.addEventListener("popstate",(function(t){t.preventDefault();let e=window.location.hash;""===e&&document.body.classList.contains("is-popup-active")?p(document.querySelector(".popup.is-active")):""===e||document.body.classList.contains("is-popup-active")||c(e,!1)})),i){let t=new URL(window.location);t.hash&&c(t.hash,!0)}}}}